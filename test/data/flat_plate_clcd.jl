# Flat Plate Experimental data from "Basic Understanding of Airfoil Characteristics at Low Reynolds Numbers (104–105)" by Winslow et al DOI: 10.2514/1.C034415.
# Original experimental data actually comes from Okamoto, M., Yasuda, K., and Azuma, A., “Aerodynamic Characteristics of the Wings and Body of a Dragonfly,” The Journal of Experimental Biology, Vol. 199, No. 2, 1996, pp. 281–294.
#

using FLOWMath
include("../../plots_default.jl")
using CCBlade

### --- THICKNESS PLATES --- ###
# 1% thickness flat plat lift coefficients, 1st column is angle of attack (in degrees), second column is lift coefficient.  For Re=1e4.
cl_1t = [
    1.3665943600867676 0.1280575539568345
    2.1475054229934916 0.19280575539568345
    2.885032537960954 0.25323741007194245
    3.5791757049891535 0.3237410071942446
    4.360086767895878 0.3856115107913668
    4.9023861171366585 0.45611510791366894
    5.683297180043383 0.5266187050359712
    6.3340563991323195 0.6071942446043165
    7.071583514099783 0.6575539568345323
    7.830802603036877 0.6949640287769783
    8.655097613882862 0.7093525179856114
    9.392624728850326 0.7136690647482014
    10.130151843817785 0.7223021582733812
    10.780911062906721 0.7410071942446042
    11.496746203904554 0.7467625899280574
    12.299349240780913 0.7553956834532373
    13.036876355748372 0.7755395683453237
    13.73101952277657 0.7841726618705035
    14.468546637744033 0.7827338129496402
    15.249457700650758 0.79568345323741
    15.986984815618221 0.828776978417266
    16.681127982646423 0.8201438848920862
    17.462039045553148 0.8172661870503596
    18.24295010845987 0.8316546762589927
    18.98047722342733 0.8417266187050358
    19.718004338394795 0.8330935251798559
]

#drag for 1% thickness flat plate
cd_1t = [
    0.0 0.028528974739970292
    0.7666290868094707 0.030929171741064077
    1.3754227733934608 0.026192434554929978
    2.119503945885005 0.030375022405524033
    2.908680947012402 0.03515330404003003
    3.5625704622322436 0.04349368708654472
    4.284103720405862 0.05956267767371187
    4.983089064261557 0.06433827902122619
    5.772266065388952 0.07565445070030874
    6.4261555806087935 0.0881553092297358
    7.125140924464486 0.10541233702598701
    7.869222096956032 0.1196989367636539
    8.658399098083425 0.13220381572356854
    9.267192784667419 0.1399485049861714
    10.011273957158963 0.15066898288134195
    10.800450958286358 0.16376821548167264
    11.567080045095828 0.17983854621233564
    12.243517474633599 0.1899626602518464
    13.03269447576099 0.2054393074138413
    13.686583990980832 0.22328934870701278
    14.43066516347238 0.2328211193213513
    15.174746335963924 0.24651336541860214
    15.941375422773394 0.2649611107109293
    16.708004509582864 0.27865402687992813
    17.54227733934611 0.28878283142167444
    18.1510710259301 0.3042541180096858
    19.052987598647125 0.32270588373250064
    19.66178128523112 0.3352054021184318
]

# 3% thickness flat plat lift coefficients, 1st column is angle of attack (in degrees), second column is lift coefficient.  For Re=1e4.
cl_3t = [
    1.1930585683297172 0.12661870503597128
    1.7136659436008674 0.18705035971223016
    2.5596529284164857 0.23884892086330933
    3.2537960954446845 0.29352517985611504
    4.056399132321041 0.3942446043165466
    4.663774403470716 0.43597122302158264
    5.357917570498915 0.5064748201438848
    6.203904555314533 0.5640287769784171
    6.854663774403471 0.6215827338129496
    7.570498915401299 0.6503597122302158
    8.2646420824295 0.656115107913669
    9.002169197396963 0.6546762589928057
    9.718004338394792 0.6489208633093524
    10.498915401301517 0.6503597122302158
    11.214750542299349 0.6762589928057553
    11.952277657266812 0.6719424460431653
    12.64642082429501 0.6805755395683453
    13.405639913232104 0.6949640287769783
    14.164859002169198 0.6920863309352516
    14.880694143167027 0.6978417266187049
    15.61822125813449 0.7107913669064747
    16.399132321041215 0.7294964028776978
    17.093275488069413 0.7323741007194243
    17.917570498915403 0.7381294964028776
    18.655097613882862 0.7410071942446042
    19.392624728850326 0.7568345323741006
]

#drag for 3% thickness flat plate
cd_3t = [
    0.6087936865839909 0.03746237128340513
    1.3979706877113873 0.04224065291791118
    2.1420518602029315 0.0446401798472571
    2.7959413754227738 0.048820087410859414
    3.4949267192784665 0.06488840792627865
    4.306651634723788 0.07085606691336471
    4.983089064261557 0.0833575955145397
    5.682074408117249 0.09288802598538232
    6.4261555806087935 0.10479721116138507
    7.125140924464486 0.11611070255347589
    7.869222096956032 0.133369070493223
    8.568207440811722 0.14230514732364963
    9.267192784667419 0.15421299235615654
    9.92108229988726 0.17027997272807982
    10.822998872604284 0.18041078748506995
    11.567080045095828 0.19113126538024056
    12.153325817361893 0.2048188209752559
    12.965050732807214 0.21435260180483823
    13.79932356257046 0.23161365003157708
    14.453213077790302 0.23698226487601157
    15.174746335963924 0.25067384090151446
    15.896279594137543 0.2649597705674335
    16.73055242390079 0.27806034331126006
    17.474633596392334 0.2971017721722553
    18.26381059751973 0.31079535841300204
    18.759864712514094 0.31318751455312077
    19.68432919954904 0.33698913311142786
]

# 5% thickness flat plat lift coefficients, 1st column is angle of attack (in degrees), second column is lift coefficient.  For Re=1e4.
cl_5t = [
    2.0390455531453355 0.17985611510791355
    2.863340563991323 0.26043165467625895
    3.51409978308026 0.339568345323741
    4.989154013015184 0.493525179856115
    5.683297180043383 0.5568345323741006
    6.3340563991323195 0.5971223021582732
    7.20173535791757 0.59136690647482
    7.960954446854662 0.5999999999999999
    8.698481561822124 0.5999999999999999
    9.436008676789587 0.5999999999999999
    10.130151843817785 0.6028776978417265
    10.867678958785248 0.6028776978417265
    11.583514099783077 0.6057553956834532
    12.299349240780913 0.6086330935251798
    12.97180043383948 0.6258992805755395
    13.774403470715832 0.651798561151079
    14.533622559652926 0.6546762589928057
    15.27114967462039 0.674820143884892
    16.073752711496745 0.6733812949640287
    16.811279826464204 0.6920863309352516
    17.54880694143167 0.6949640287769783
    18.24295010845987 0.6863309352517986
    19.067245119305856 0.7194244604316546
    19.80477223427332 0.716546762589928
]

# 5% thickness drag
cd_5t = [
    0.676437429537768 0.05588934435154641
    1.4205186020293121 0.05591145671922815
    2.09695603156708 0.06128074163541053
    2.8184892897406995 0.06665136669508881
    3.4723788049605417 0.07201998153952333
    4.261555806087936 0.08809098234193424
    5.050732807215332 0.09405797125727233
    5.794813979706876 0.10537280279285899
    6.4261555806087935 0.11608993032928999
    7.170236753100338 0.12978217642654083
    7.824126268320179 0.13752820583263953
    8.523111612175875 0.15478523362889074
    9.40248027057497 0.15956619555038853
    9.966178128523111 0.17563049563532013
    10.665163472378804 0.18516092610616278
    11.521984216459977 0.20004522984298542
    12.198421645997744 0.21373546572499247
    12.942502818489288 0.2256446509009952
    13.66403607666291 0.23636445872441791
    14.543404735062005 0.2542212007350687
    15.197294250281846 0.2649389983432476
    15.918827508455468 0.272092684324174
    16.57271702367531 0.28815966469609733
    17.49718151071026 0.30304597864816374
    18.1510710259301 0.3179242517392549
    18.782412626832016 0.32032042830986124
    19.729425028184895 0.34055659509742003
]

## -- Extrapolations and Corrections -- ##
# - Get smoothed angle of attack values in the ranges you have data - #
alpha_t_min = max(cl_1t[1, 1], cl_3t[1, 1], cl_5t[1, 1],cd_1t[1, 1], cd_3t[1, 1], cd_5t[1, 1])
# alpha_t_max = min(cl_1t[end, 1], cl_3t[end, 1], cl_5t[end, 1])
alpha_t_max = 15.0
alpha_t = range(alpha_t_min, alpha_t_max; step=0.5)# .* pi / 180

# - Use Akima Splines to smooth all the data - #
cl_1t_smooth = FLOWMath.akima(cl_1t[:, 1], cl_1t[:, 2], alpha_t)
cl_3t_smooth = FLOWMath.akima(cl_3t[:, 1], cl_3t[:, 2], alpha_t)
cl_5t_smooth = FLOWMath.akima(cl_5t[:, 1], cl_5t[:, 2], alpha_t)
cd_1t_smooth = FLOWMath.akima(cd_1t[:, 1], cd_1t[:, 2], alpha_t)
cd_3t_smooth = FLOWMath.akima(cd_3t[:, 1], cd_3t[:, 2], alpha_t)
cd_5t_smooth = FLOWMath.akima(cd_5t[:, 1], cd_5t[:, 2], alpha_t)

plot(; xlabel="Angle of Attack (degrees)", ylabel=L"c_\ell")
plot!(
    cl_1t[:, 1],
    cl_1t[:, 2];
    label="exp data 1% thickness",
    seriestype=:scatter,
    markersize=2,
)
plot!(
    [-reverse(alpha_t); alpha_t],
    [-reverse(cl_1t_smooth); cl_1t_smooth];
    label="smoothed 1%",
)

plot!(
    cl_3t[:, 1],
    cl_3t[:, 2];
    label="exp data 3% thickness",
    seriestype=:scatter,
    markersize=2,
)
plot!(
    [-reverse(alpha_t); alpha_t],
    [-reverse(cl_3t_smooth); cl_3t_smooth];
    label="smoothed 3%",
)

plot!(
    cl_5t[:, 1],
    cl_5t[:, 2];
    label="exp data 5% thickness",
    seriestype=:scatter,
    markersize=2,
)
plot!(
    [-reverse(alpha_t); alpha_t],
    [-reverse(cl_5t_smooth); cl_5t_smooth];
    label="smoothed 5%",
)

savefig("flat_plate_thickness_lift.pdf")

plot(; xlabel="Angle of Attack (degrees)", ylabel=L"c_d")
plot!(
    cd_1t[:, 1],
    cd_1t[:, 2];
    label="exp data 1% thickness",
    seriestype=:scatter,
    markersize=2,
)
plot!(
    [-reverse(alpha_t); alpha_t],
    [-reverse(cd_1t_smooth); cd_1t_smooth];
    label="smoothed 1%",
)
plot!(
    cd_3t[:, 1],
    cd_3t[:, 2];
    label="exp data 3% thickness",
    seriestype=:scatter,
    markersize=2,
)
plot!(
    [-reverse(alpha_t); alpha_t],
    [-reverse(cd_3t_smooth); cd_3t_smooth];
    label="smoothed 3%",
)
plot!(
    cd_5t[:, 1],
    cd_5t[:, 2];
    label="exp data 5% thickness",
    seriestype=:scatter,
    markersize=2,
)
plot!(
    [-reverse(alpha_t); alpha_t],
    [-reverse(cd_5t_smooth); cd_5t_smooth];
    label="smoothed 5%",
)
savefig("flat_plate_thickness_drag.pdf")

# - Viterna Extraploation - #
cr75 = 0.57
alpha_1t_ext, cl_1t_ext, cd_1t_ext = viterna(
    [-reverse(alpha_t); alpha_t] * pi / 180.0,
    [-reverse(cl_1t_smooth); cl_1t_smooth],
    [reverse(cd_1t_smooth); cd_1t_smooth],
    cr75,
)
alpha_3t_ext, cl_3t_ext, cd_3t_ext = viterna(
    [-reverse(alpha_t); alpha_t] * pi / 180.0,
    [-reverse(cl_3t_smooth); cl_3t_smooth],
    [reverse(cd_3t_smooth); cd_3t_smooth],
    cr75,
)
alpha_5t_ext, cl_5t_ext, cd_5t_ext = viterna(
    [-reverse(alpha_t); alpha_t] * pi / 180.0,
    [-reverse(cl_5t_smooth); cl_5t_smooth],
    [reverse(cd_5t_smooth); cd_5t_smooth],
    cr75,
)

plot(; xlabel="angle of attack, radians", ylabel=L"c_\ell")
plot!(alpha_1t_ext, cl_1t_ext; label="1% extrapolated")
plot!(alpha_3t_ext, cl_3t_ext; label="3% extrapolated")
plot!(alpha_5t_ext, cl_5t_ext; label="5% extrapolated")
savefig("flat_plate_extrapolated_thickness_lift.pdf")

plot(; xlabel="angle of attack, radians", ylabel=L"c_d")
plot!(alpha_1t_ext, cd_1t_ext; label="1% extrapolated")
plot!(alpha_3t_ext, cd_3t_ext; label="3% extrapolated")
plot!(alpha_5t_ext, cd_5t_ext; label="5% extrapolated")
savefig("flat_plate_extrapolated_thickness_drag.pdf")

# - Rotation Corrections - #
# 1% thickness
alpha_1t_rot = alpha_1t_ext
cl_1t_rot = similar(cl_1t_ext)
cd_1t_rot = similar(cd_1t_ext)

rR = 0.75  # r/R = 75%
tsr = 9.0  # representative tip-speed ratio

for i in 1:length(cl_1t_ext)
    cl_1t_rot[i], cd_1t_rot[i] = rotation_correction(
        DuSeligEggers(), cl_1t_ext[i], cd_1t_ext[i], cr75, rR, tsr, alpha_1t_ext[i]
    )
end

# 3% thickness
alpha_3t_rot = alpha_3t_ext
cl_3t_rot = similar(cl_3t_ext)
cd_3t_rot = similar(cd_3t_ext)

rR = 0.75  # r/R = 75%
tsr = 9.0  # representative tip-speed ratio

for i in 1:length(cl_3t_ext)
    cl_3t_rot[i], cd_3t_rot[i] = rotation_correction(
        DuSeligEggers(), cl_3t_ext[i], cd_3t_ext[i], cr75, rR, tsr, alpha_3t_ext[i]
    )
end

# 5% thickness
alpha_5t_rot = alpha_5t_ext
cl_5t_rot = similar(cl_5t_ext)
cd_5t_rot = similar(cd_5t_ext)

rR = 0.75  # r/R = 75%
tsr = 9.0  # representative tip-speed ratio

for i in 1:length(cl_5t_ext)
    cl_5t_rot[i], cd_5t_rot[i] = rotation_correction(
        DuSeligEggers(), cl_5t_ext[i], cd_5t_ext[i], cr75, rR, tsr, alpha_5t_ext[i]
    )
end

plot(; xlabel="angle of attack, radians", ylabel=L"c_\ell")
plot!(alpha_1t_rot, cl_1t_rot; label="1% rotation corrected")
plot!(alpha_3t_rot, cl_3t_rot; label="3% rotation corrected")
plot!(alpha_5t_rot, cl_5t_rot; label="5% rotation corrected")
savefig("flat_plate_rotated_thickness_lift.pdf")

plot(; xlabel="angle of attack, radians", ylabel=L"c_d")
plot!(alpha_1t_rot, cd_1t_rot; label="1% rotation corrected")
plot!(alpha_3t_rot, cd_3t_rot; label="3% rotation corrected")
plot!(alpha_5t_rot, cd_5t_rot; label="5% rotation corrected")
savefig("flat_plate_rotated_thickness_drag.pdf")

### --- CAMBER PLATES --- ###
# lift coefficient for 3% camber (1% thick) flat plate at Re = 1e4
cl_3cam = [
    -2.8426225689996496 -0.22743682310469326
    -2.1178991498777213 -0.10288808664259941
    -1.4451612903225808 0
    -0.7212763479678586 0.07581227436823101
    -0.04853848841271713 0.17870036101083042
    0.6754862000698729 0.262635379061372
    1.425363922207989 0.34927797833935026
    2.097216722953302 0.40072202166064996
    2.82049609875393 0.4413357400722022
    3.5958076161639667 0.506317689530686
    4.267613834866658 0.5550541516245489
    5.095143822056597 0.6552346570397114
    5.664050308606033 0.7229241877256319
    6.490881565156631 0.782490974729242
    7.214393851170373 0.8366425992779785
    7.80892046116222 0.8935018050541518
    8.661138930942123 0.9287003610108305
    9.384697798998488 0.9855595667870038
    10.029859089321068 0.9855595667870038
    10.855572376848727 0.9801444043321302
    11.577780365669032 0.9584837545126357
    12.248608361476652 0.9503610108303251
    13.074135320833822 0.9341155234657041
    13.66759054384535 0.9287003610108305
    14.545009898684057 0.9287003610108305
    15.215977640619542 0.9287003610108305
    15.938558285780829 0.9287003610108305
    16.712658670082682 0.9232851985559569
    17.486945382555025 0.9287003610108305
    18.26123209502737 0.9341155234657041
    19.035239315243974 0.9232851985559569
]

#drag coefficient for 3% camber flat plate
cd_3cam = [
    -3.6411609498680733 0.0672937771345875
    -2.849604221635884 0.06078147612156293
    -2.0316622691292867 0.05166425470332847
    -1.5039577836411606 0.04688856729377716
    -0.738786279683378 0.03950795947901592
    0.052770448548812965 0.03690303907380604
    0.8179419525065956 0.03950795947901592
    1.5039577836411606 0.03690303907380604
    2.163588390501319 0.03907380607814759
    2.823218997361476 0.03690303907380604
    3.6147757255936668 0.043849493487698954
    4.353562005277045 0.04341534008683068
    5.0131926121372015 0.05079594790159192
    5.67282321899736 0.05383502170767002
    6.464379947229551 0.06382054992764108
    7.25593667546174 0.07293777134587554
    7.862796833773086 0.08465991316931981
    8.62796833773087 0.10680173661360345
    9.366754617414244 0.11895803183791603
    10.131926121372029 0.14630969609261937
    10.738786279683378 0.16324167872648332
    11.609498680738785 0.17670043415340084
    12.242744063324537 0.19276410998552818
    13.007915567282318 0.20926193921852385
    13.72031662269129 0.22272069464544136
    14.51187335092348 0.24052098408104194
    15.171503957783639 0.25397973950795943
    15.96306068601583 0.26613603473227204
    16.781002638522423 0.2765557163531114
    17.46701846965699 0.2904486251808972
]

# lift coefficient for 6% camber (1% thick) flat plate at Re = 1e4
cl_6cam = [
    -2.039454990101315 -0.04332129963898912
    -1.2881798066845223 0.12454873646209408
    -0.7182950972400146 0.2490974729241877
    0.0582741353208327 0.3871841155234659
    0.6795854198206595 0.5009025270758125
    1.4549435192733196 0.5685920577617329
    2.1528356818446497 0.6335740072202167
    2.8763013858157684 0.6850180505415164
    3.4964481192500276 0.7310469314079423
    4.374566204728078 0.7716606498194948
    5.0462326773029 0.8122743682310472
    5.769605217188774 0.858303249097473
    6.545009898684057 0.9287003610108305
    7.2177011761965755 1.0288808664259932
    7.993105857691859 1.0992779783393503
    8.587632467683708 1.1561371841155237
    9.362385000582275 1.1886281588447656
    10.136997787352975 1.2129963898916971
    10.808291603586817 1.2319494584837547
    11.530266682194014 1.196750902527076
    12.355560731338066 1.166967509025271
    13.077628974030514 1.1371841155234659
    13.774123675323164 1.1209386281588452
    14.521905205543263 1.0857400722021664
    15.218353324793291 1.0667870036101086
    15.992267380924648 1.0505415162454876
    16.766460929311748 1.0505415162454876
    17.59222079888203 1.0478339350180508
    18.211622219634325 1.0505415162454876
    19.037288925119366 1.042418772563177
]

#drag coefficient for 6% camber flat plate
cd_6cam = [
    -3.5092348284960417 0.09898697539797394
    -2.902374670184697 0.08943560057887118
    -2.2955145118733506 0.08769898697539796
    -1.3984168865435356 0.08509406657018811
    -0.5804749340369391 0.0655571635311143
    0.052770448548812965 0.059044862518089714
    0.738786279683378 0.05687409551374817
    1.4248021108179412 0.0573082489146165
    2.0316622691292867 0.06078147612156293
    2.823218997361476 0.06295224312590447
    3.6147757255936668 0.06382054992764108
    4.274406332453825 0.0655571635311143
    4.9604221635883885 0.07076700434153402
    5.751978891820578 0.07554269175108536
    6.464379947229551 0.0833574529667149
    7.308707124010553 0.08943560057887118
    7.9683377308707115 0.09898697539797394
    8.575197889182057 0.11157742402315485
    9.208443271767809 0.12547033285094064
    10.211081794195248 0.14717800289435598
    10.976253298153033 0.15933429811866856
    11.662269129287598 0.1871201157742402
    12.269129287598943 0.19710564399421127
    13.166226912928757 0.22793053545586103
    13.72031662269129 0.24052098408104194
    14.564643799472293 0.25050651230101295
    15.277044854881265 0.27481910274963817
    16.015831134564642 0.2895803183791606
]

# lift coefficient for 9% camber (1% thick) flat plate at Re = 1e4
cl_9cam = [
    -2.2190753464539412 0.016245487364620947
    -1.5458250844299517 0.1489169675090254
    -0.8208221730522878 0.28971119133573997
    -0.018073832537556456 0.4494584837545128
    0.6811692092698269 0.5929602888086645
    1.4569465471060905 0.6850180505415164
    2.15502503784791 0.7608303249097474
    2.77535809945266 0.8176895306859208
    3.6022825200885045 0.8826714801444046
    4.325748224059625 0.9341155234657041
    5.048701525561896 0.9557761732851988
    5.72022825200885 0.9882671480144406
    6.391987888668918 1.0342960288808667
    7.192826365436124 1.0830324909747295
    7.915965995108884 1.1155234657039714
    8.641621055083263 1.2942238267148016
    9.44241294980785 1.3402527075812278
    10.140258530336553 1.4025270758122748
    10.81183183882613 1.4377256317689535
    11.482985908932108 1.4485559566787007
    12.282706416676373 1.4323104693140798
    12.97878187958542 1.3916967509025273
    13.72660999184814 1.3592057761732854
    14.396459764760682 1.2942238267148016
    15.170140910678931 1.2644404332129966
    15.943030161872596 1.1886281588447656
    16.66579713520438 1.1994584837545128
    17.439431699080004 1.166967509025271
    18.213438919296607 1.1561371841155237
    18.987632467683706 1.1561371841155237
]

#drag coefficient for 6% camber flat plate
cd_9cam = [
    -3.5620052770448547 0.1028943560057887
    -2.902374670184697 0.10506512301013024
    -2.1372031662269135 0.09681620839363242
    -1.3984168865435356 0.08943560057887118
    -0.6596306068601585 0.08943560057887118
    0.052770448548812965 0.08639652677279303
    0.7915567282321891 0.08943560057887118
    1.319261213720317 0.09507959479015915
    2.058047493403693 0.09942112879884221
    2.823218997361476 0.10332850940665703
    3.562005277044854 0.10853835021707667
    4.30079155672823 0.11722141823444279
    4.907651715039577 0.12373371924746743
    5.67282321899736 0.12373371924746743
    6.464379947229551 0.12720694645441386
    7.124010554089708 0.14283646888567292
    7.862796833773086 0.1567293777134587
    8.522427440633244 0.16280752532561504
    9.313984168865431 0.17149059334298117
    10.07915567282322 0.1806078147612156
    10.712401055408968 0.20101302460202602
    11.42480211081794 0.21447178002894352
    12.110817941952504 0.2400868306801736
    12.875989445910285 0.2587554269175108
    13.667546174142476 0.2839363241678726
]

## -- Extrapolations and Corrections -- ##
# - Get smoothed angle of attack values in the ranges you have data - #
alpha_cam_min = max(cl_3cam[1, 1], cl_6cam[1, 1], cd_3cam[1, 1], cd_6cam[1, 1])
alpha_cam_max = min(cl_3cam[end, 1], cl_6cam[end, 1], cd_3cam[end, 1], cd_6cam[end, 1])

# alpha_cam_max = 15.0
alpha_cam = range(alpha_cam_min, alpha_cam_max; step=0.5)# .* pi / 180

# - Use Akima Splines to smooth all the data - #
cl_3cam_smooth = FLOWMath.akima(cl_3cam[:, 1], cl_3cam[:, 2], alpha_cam)
cl_6cam_smooth = FLOWMath.akima(cl_6cam[:, 1], cl_6cam[:, 2], alpha_cam)
cd_3cam_smooth = FLOWMath.akima(cd_3cam[:, 1], cd_3cam[:, 2], alpha_cam)
cd_6cam_smooth = FLOWMath.akima(cd_6cam[:, 1], cd_6cam[:, 2], alpha_cam)

plot(; xlabel="Angle of Attack (degrees)", ylabel=L"c_\ell")

plot!(
    cl_3cam[:, 1],
    cl_3cam[:, 2];
    label="exp data 3% camber",
    seriestype=:scatter,
    markersize=2,
)
plot!(alpha_cam, cl_3cam_smooth; label="smoothed 3%")

plot!(
    cl_6cam[:, 1],
    cl_6cam[:, 2];
    label="exp data 6% camber",
    seriestype=:scatter,
    markersize=2,
)
plot!(alpha_cam, cl_6cam_smooth; label="smoothed 6%")

savefig("flat_plate_camber_lift.pdf")

plot(; xlabel="Angle of Attack (degrees)", ylabel=L"c_d")
plot!(
    cd_3cam[:, 1],
    cd_3cam[:, 2];
    label="exp data 3% camber",
    seriestype=:scatter,
    markersize=2,
)
plot!(alpha_cam, cd_3cam_smooth; label="smoothed 3%")

plot!(
    cd_6cam[:, 1],
    cd_6cam[:, 2];
    label="exp data 6% camber",
    seriestype=:scatter,
    markersize=2,
)
plot!(alpha_cam, cd_6cam_smooth; label="smoothed 6%")

savefig("flat_plate_camber_drag.pdf")

# - Viterna Extraploation - #
cr75 = 0.57
alpha_3cam_ext, cl_3cam_ext, cd_3cam_ext = viterna(
    alpha_cam * pi / 180.0,
     cl_3cam_smooth,
     cd_3cam_smooth,
    cr75,
)
alpha_6cam_ext, cl_6cam_ext, cd_6cam_ext = viterna(
     alpha_cam * pi / 180.0,
     cl_6cam_smooth,
     cd_6cam_smooth,
    cr75,
)

plot(; xlabel="angle of attack, radians", ylabel=L"c_\ell")
plot!(alpha_3cam_ext, cl_3cam_ext; label="3% extrapolated")
plot!(alpha_6cam_ext, cl_6cam_ext; label="6% extrapolated")
savefig("flat_plate_extrapolated_camber_lift.pdf")

plot(; xlabel="angle of attack, radians", ylabel=L"c_d")
plot!(alpha_3cam_ext, cd_3cam_ext; label="3% extrapolated")
plot!(alpha_6cam_ext, cd_6cam_ext; label="6% extrapolated")
savefig("flat_plate_extrapolated_camber_drag.pdf")

# - Rotation Corrections - #

rR = 0.75  # r/R = 75%
tsr = 9.0  # representative tip-speed ratio

# 3% camber
alpha_3cam_rot = alpha_3cam_ext
cl_3cam_rot = similar(cl_3cam_ext)
cd_3cam_rot = similar(cd_3cam_ext)

rR = 0.75  # r/R = 75%
tsr = 9.0  # representative tip-speed ratio

for i in 1:length(cl_3cam_ext)
    cl_3cam_rot[i], cd_3cam_rot[i] = rotation_correction(
        DuSeligEggers(), cl_3cam_ext[i], cd_3cam_ext[i], cr75, rR, tsr, alpha_3cam_ext[i]
    )
end

# 6% camber
alpha_6cam_rot = alpha_6cam_ext
cl_6cam_rot = similar(cl_6cam_ext)
cd_6cam_rot = similar(cd_6cam_ext)

rR = 0.76  # r/R = 76%
tsr = 9.0  # representative tip-speed ratio

for i in 1:length(cl_6cam_ext)
    cl_6cam_rot[i], cd_6cam_rot[i] = rotation_correction(
        DuSeligEggers(), cl_6cam_ext[i], cd_6cam_ext[i], cr75, rR, tsr, alpha_6cam_ext[i]
    )
end

plot(; xlabel="angle of attack, radians", ylabel=L"c_\ell")
plot!(alpha_3cam_rot, cl_3cam_rot; label="3% rotation corrected")
plot!(alpha_6cam_rot, cl_6cam_rot; label="6% rotation corrected")
savefig("flat_plate_rotated_camber_lift.pdf")

plot(; xlabel="angle of attack, radians", ylabel=L"c_d")
plot!(alpha_3cam_rot, cd_3cam_rot; label="3% rotation corrected")
plot!(alpha_6cam_rot, cd_6cam_rot; label="6% rotation corrected")
savefig("flat_plate_rotated_camber_drag.pdf")
