<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Options · DuctAPE.jl</title><meta name="title" content="Options · DuctAPE.jl"/><meta property="og:title" content="Options · DuctAPE.jl"/><meta property="twitter:title" content="Options · DuctAPE.jl"/><meta name="description" content="Documentation for DuctAPE.jl."/><meta property="og:description" content="Documentation for DuctAPE.jl."/><meta property="twitter:description" content="Documentation for DuctAPE.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="DuctAPE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">DuctAPE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">DuctAPE</span><ul><li><a class="tocitem" href="../../tutorial/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Advanced Usage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Options</a><ul class="internal"><li><a class="tocitem" href="#General-Option-Selection"><span>General Option Selection</span></a></li><li><a class="tocitem" href="#Quadrature"><span>Quadrature</span></a></li><li><a class="tocitem" href="#Elliptic-Grid-Solvers"><span>Elliptic Grid Solvers</span></a></li><li><a class="tocitem" href="#Aerodynamics-Solvers"><span>Aerodynamics Solvers</span></a></li><li><a class="tocitem" href="#Boundary-Layer-Solvers"><span>Boundary Layer Solvers</span></a></li><li><a class="tocitem" href="#Advanced-Options-for-Multi-point-analyses"><span>Advanced Options for Multi-point analyses</span></a></li></ul></li><li><a class="tocitem" href="../precompilation/">Preallocation</a></li><li><a class="tocitem" href="../outputs/">Outputs</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/public_api/">Public API Reference</a></li><li><input class="collapse-toggle" id="menuitem-2-4-2" type="checkbox"/><label class="tocitem" for="menuitem-2-4-2"><span class="docs-label">Private API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/private_prelims/">Prelims</a></li><li><a class="tocitem" href="../../api/private_preprocess/">Preprocess</a></li><li><a class="tocitem" href="../../api/private_process/">Process</a></li><li><a class="tocitem" href="../../api/private_postprocess/">Postprocess</a></li><li><a class="tocitem" href="../../api/private_utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../api/api_index/">API Index</a></li></ul></li><li><a class="tocitem" href="../../theory/">Theory</a></li></ul></li><li><span class="tocitem">C<span>$^4$</span>Blade</span><ul><li><a class="tocitem" href="../../../C4Blade/intro/">Intro</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Blade Element Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../C4Blade/airfoil_types/DFDC/">DFDC Airfoil Type</a></li><li><a class="tocitem" href="../../../C4Blade/airfoil_types/CCBlade/">CCBlade Airfoil Types</a></li><li><a class="tocitem" href="../../../C4Blade/airfoil_types/actuator_disk/">Actuator Disk Type</a></li><li><a class="tocitem" href="../../../C4Blade/airfoil_types/cascade/">Cascade Types</a></li></ul></li><li><a class="tocitem" href="../../../C4Blade/corrections/">Polar Modification</a></li><li><a class="tocitem" href="../../../C4Blade/api/">API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">DuctAPE</a></li><li><a class="is-disabled">Advanced Usage</a></li><li class="is-active"><a href>Options</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Options</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/DuctAPE.jl/blob/{commit}{path}#L{line}" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/DuctAPE.jl/blob/main/docs/src/DuctAPE/advanced_usage/option.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Option-Selection"><a class="docs-heading-anchor" href="#Advanced-Option-Selection">Advanced Option Selection</a><a id="Advanced-Option-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Option-Selection" title="Permalink"></a></h1><p>DuctAPE has been written in an attempt to make as many of the available options exposed to the user as possible.  This means that there are quite a few options to select from if not using the option convenience functions. To help the user, the majority of overarching option types are defined using the <code>@kwdef</code> macro and have default values that should be reasonable in most cases. We will introduce some of the available options here that may be of common interest.</p><h2 id="General-Option-Selection"><a class="docs-heading-anchor" href="#General-Option-Selection">General Option Selection</a><a id="General-Option-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#General-Option-Selection" title="Permalink"></a></h2><p>In general, options are all accessed through the <code>options</code> argument of the analysis function being called. Said options are passed via an <code>Options</code> struct.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DuctAPE.Options-DuctAPE-advanced_usage-option" href="#DuctAPE.Options-DuctAPE-advanced_usage-option"><code>DuctAPE.Options</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Options</code></pre><p>Type containing (nearly) all the available user options.</p><p><strong>Fields</strong></p><p><strong>General Options</strong></p><ul><li><code>verbose::Bool = false</code> : flag to print verbose statements</li><li><code>silence_warnings::Bool = true</code> : flag to silence warnings</li><li><code>multipoint_index::Int = [1]</code> : holds current index of multi-point solver (no need for user to change this usually)</li></ul><p><strong>Pre-processing Options</strong></p><p><strong>Geometry interpolation and generation options :</strong></p><ul><li><code>finterp::Interplation Method = FLOWMath.akima</code> : interpolation method used for re-paneling bodies</li><li><code>autoshiftduct::Bool = true</code> : flag as to whether duct geometry should be shifted based on rotor tip location</li><li><code>lu_decomp_flag::Bool = false</code> : flag indicating if panel method LHS matrix factorization was successful</li></ul><p><strong>paneling options</strong></p><ul><li><code>itcpshift::Float = 0.05</code> : factor for internal trailing edge psuedo-panel placement (default is DFDC hard-coded value)</li><li><code>axistol::Float = 1e-15</code> : tolerance for how close the the axis of rotation should be considered on the axis</li><li><code>tegaptol::Float = 1e1 * eps()</code> : tolerance for how large of a trailing edge gap should be considered a gap</li></ul><p><strong>Integration Options</strong></p><ul><li><code>integration_options::IntegrationOptions type = IntegrationOptions()</code> : integration options</li></ul><p><strong>Post-processing Options</strong></p><ul><li><code>boundary_layer_options::BoundaryLayerOptions</code> : BoundaryLayerOptions object</li><li><code>write_outputs::AbstractArray{Bool} = [false]</code> : Bool for whether to write the outputs of the analysis to an external file (slow)</li><li><code>outfile::AbstractArray{String} = [&quot;outputs.jl&quot;]</code> : External output file name (including path information) for files to write</li><li><code>checkoutfileexists::Bool = false</code> : Flag for whether to check if file exists before overwriting</li><li><code>output_tuple_name::AbstractArray{String} = [&quot;outs&quot;]</code> : variable name for named tuple written to out file</li></ul><p><strong>Solving Options</strong></p><ul><li><code>grid_solver_options::GridSolverOptionsType = GridSolverOptions()</code> : elliptic grid solver options</li><li><code>solver_options::SolverOptionsType = ChainSolverOptions()</code> : solver options</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/DuctAPE.jl/blob/a5ff2ada026adb81962b884154d94aa7bd5f76ae/src/utilities/options.jl#L729-L759">source</a></section></article><p>Options are selected through the <code>set_options</code> function</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DuctAPE.set_options-DuctAPE-advanced_usage-option" href="#DuctAPE.set_options-DuctAPE-advanced_usage-option"><code>DuctAPE.set_options</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_options(; kwargs...)
set_options(multipoint; kwargs...)</code></pre><p>Set the options for DuctAPE to use.</p><p>Note that the vast majority of the available options are defined through keyword arguments.  See the documentation for the various option types for more information.</p><p><strong>Arguments</strong></p><ul><li><code>multipoint::AbstractArray{OperatingPoint}</code> : a vector of operating points to use if running a multi-point analysis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/DuctAPE.jl/blob/a5ff2ada026adb81962b884154d94aa7bd5f76ae/src/utilities/options.jl#L798-L808">source</a></section></article><p>There are three main sub-option objects for quadrature, wake geometry solver, and aerodyanmic solver; these are explained in more detail below. In addition, there are various options for pre- and post-processing as well as miscellaneous options for things such as supressing warnings and printing verbose statements throughout the analysis, which can be seen in the docstring above.</p><h2 id="Quadrature"><a class="docs-heading-anchor" href="#Quadrature">Quadrature</a><a id="Quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Quadrature" title="Permalink"></a></h2><p>There are several implementations for different quadrature approaches depending on user desires; they include:</p><ul><li><a href="../../api/public_api/#DuctAPE.GaussLegendre">Gauss-Legendre quadature</a> (default),</li><li><a href="../../api/public_api/#DuctAPE.GaussKronrod">Gauss-Kronrod Quadrature</a>, and</li><li><a href="../../api/public_api/#DuctAPE.Romberg">Romberg Quadrature</a> methods.</li></ul><p>The default method is Gauss-Legendre quadrature using 8 sample points for both the nominal and singular integrals. To modify the quadrature methods and settings, an <code>IntegrationOptions</code> struct needs to be passed to the <code>set_options</code> method.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DuctAPE.IntegrationOptions-DuctAPE-advanced_usage-option" href="#DuctAPE.IntegrationOptions-DuctAPE-advanced_usage-option"><code>DuctAPE.IntegrationOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct IntegrationOptions</code></pre><p>A struct used to hold the integration options for both the nominal and singular cases.</p><p><strong>Fields</strong></p><ul><li><code>nominal::IntegrationMethod=GaussLegendre(8)</code> : the integration options to use for the nominal case.</li><li><code>singular::IntegrationMethod=GaussLegendre(8)</code> : the integration options to use for the self-induced case.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/DuctAPE.jl/blob/a5ff2ada026adb81962b884154d94aa7bd5f76ae/src/utilities/options.jl#L144-L152">source</a></section></article><p>The <code>IntegraionOptions</code> type takes in two objects of type <code>IntegrationMethod</code>, one for the nominal integrals, and one for the singular integrals. These methods can be mixed and matched between quadrature methods as well as settings.</p><p>For example, if one wanted to use a 10-point Gauss-Legendre method for the nominal integrals, and a order 7 Gauss-Kronrod method with an absolute tolerance of 2e-16 the following would need to be included in the <code>set_options</code> call:</p><pre><code class="language-julia hljs"># set nominal options using a GaussLegendre object (which is an InterationMethod type)
# note that a convenience method is used here that takes in the number of points and
#calculates the appropriate sample locations and weights.
nominal_integration_method = DuctAPE.GaussLegendre(10)

# set singular options using a GaussKronrod object (which is an InterationMethod type)
# note that like most option structs, these are defined using @kwdef allowing the fields
#to be treated as keyword arguments.
# also note that we haven&#39;t changed the evaluation limit (default 10^7)
singular_integration_method = DuctAPE.GaussKronrod(; order=7, atol=2e-16)

# put the quadrature options together
integration_options = DuctAPE.IntegrationOptions(;
    nominal=nominal_integration_method, singular=singular_integration_method
)

# example of calling the set_options function
options = DuctAPE.set_options(; integration_options=integration_options)</code></pre><h2 id="Elliptic-Grid-Solvers"><a class="docs-heading-anchor" href="#Elliptic-Grid-Solvers">Elliptic Grid Solvers</a><a id="Elliptic-Grid-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Elliptic-Grid-Solvers" title="Permalink"></a></h2><p>As part of the pre-process, an elliptic grid defining the wake geometry is solved with a system of Poisson equations. For this solve there currently two options:</p><ul><li><a href="../../api/public_api/#DuctAPE.SLORGridSolverOptions">SLOR</a>: DFDC grid solver</li><li><a href="../../api/public_api/#DuctAPE.GridSolverOptions">Default</a>: Default method compatible with ImplicitAD</li></ul><p>The SLOR (successive line over relaxation) is the method employed by DFDC.</p><p>Selection of solver and solver settings follows the same pattern as with the quadrature settings, in that the user must pass the appropriate <code>GridSolverOptionsType</code> into the <code>set_options</code> call.</p><p>For the SLOR method alone, the type is</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DuctAPE.SLORGridSolverOptions-DuctAPE-advanced_usage-option" href="#DuctAPE.SLORGridSolverOptions-DuctAPE-advanced_usage-option"><code>DuctAPE.SLORGridSolverOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SLORGridSolverOptions &lt;: GridSolverOptionsType</code></pre><p>Options for SLOR (successive line over relaxation) elliptic grid solver.</p><p><strong>Fields</strong></p><ul><li><code>iteration_limit::Int = 100</code> : maximum number of iterations</li><li><code>atol::Float = 1e-9</code> : absolute convergence tolerance</li><li><code>converged::AbstractArray{Bool}</code> = [false]</li><li><code>iterations::AbstractArray{Int} = [0]</code> : iteration counter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/DuctAPE.jl/blob/a5ff2ada026adb81962b884154d94aa7bd5f76ae/src/utilities/options.jl#L615-L625">source</a></section></article><p>And for the default method compatible with ImplicitAD, the type is</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DuctAPE.GridSolverOptions-DuctAPE-advanced_usage-option" href="#DuctAPE.GridSolverOptions-DuctAPE-advanced_usage-option"><code>DuctAPE.GridSolverOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct GridSolverOptions &lt;: GridSolverOptionsType</code></pre><p>Options for Newton elliptic grid solver.</p><p><strong>Fields</strong></p><ul><li><code>iteration_limit::Int = 10</code> : maximum number of iterations</li><li><code>atol::Float = 1e-14</code> : absolute convergence tolerance</li><li><code>algorithm::Symbol = :newton</code> : algorithm to use in NLsolve.jl</li><li><code>autodiff::Symbol = :forward</code> : differentiation method to use in NLsolve.jl</li><li><code>converged::AbstractArray{Bool}</code> = [false]</li><li><code>iterations::AbstractArray{Int} = [0]</code> : iteration counter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/DuctAPE.jl/blob/a5ff2ada026adb81962b884154d94aa7bd5f76ae/src/utilities/options.jl#L633-L645">source</a></section></article><p>As an example, this is the input that would be required to use the default method with an absolute convergence tolerance of 1e-10, and also including the quadrature settings from above:</p><pre><code class="language-julia hljs"># define wake grid solver settings
wake_solve_options = DuctAPE.GridSolverOptions(; atol=1e-10)

# set all options
options = DuctAPE.set_options(;
    integration_options=integration_options, grid_solver_options=wake_solve_options
)</code></pre><div class="admonition is-info"><header class="admonition-header">Convergence Flags</header><div class="admonition-body"><p>The convergence flags default to false, and in general should be left alone as they are modified in-place in the various solves by the analysis.</p></div></div><h2 id="Aerodynamics-Solvers"><a class="docs-heading-anchor" href="#Aerodynamics-Solvers">Aerodynamics Solvers</a><a id="Aerodynamics-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Aerodynamics-Solvers" title="Permalink"></a></h2><p>There are two general types of solvers available in DuctAPE, the first is very similar to the solver in DFDC and converges a residual very similar to DFDC&#39;s. The other type is for external solvers that converge an alternate residual that is default in DuctAPE. The various solver options include:</p><ul><li><a href="../../api/public_api/#DuctAPE.CSORSolverOptions">CSOR</a>: the DFDC solver</li><li><a href="../../api/public_api/#DuctAPE.ModCSORSolverOptions">ModCSOR</a>: modified DFDC solver for ImplicitAD compatibility</li><li><a href="../../api/public_api/#DuctAPE.FixedPointOptions">FixedPoint.jl</a></li><li><a href="../../api/public_api/#DuctAPE.SpeedMappingOptions">SpeedMapping.jl</a></li><li><a href="../../api/public_api/#DuctAPE.MinpackOptions">MINPACK.jl</a></li><li><a href="../../api/public_api/#DuctAPE.SIAMFANLEOptions">SIAMFANLEquations.jl</a></li><li><a href="../../api/public_api/#DuctAPE.NLsolveOptions">NLsolve.jl</a></li><li><a href="../../api/public_api/#DuctAPE.NonlinearSolveOptions">SimpleNonlinearSolve.jl</a></li></ul><p>Note that the CSOR, ModCSOR, FixedPoint.jl, and SpeedMapping.jl are all different fixed-point iteration solvers, MINPACK.jl and SIAMFANLEquations.jl are primarily quasi-newton solvers, and NLsolve.jl and SimpleNonlinearSolve.jl have various solver options.</p><p>DuctAPE also has some poly-algorithm solvers that employ more than one solver. The <a href="../../api/public_api/#DuctAPE.ChainSolverOptions">Chain Solver</a> option is the default which starts with a fixed-point iteration, and if it doesn&#39;t converge, moves on to a quasi-, then full Newton solver until either convergence is reached, or no convergence is found. The other poly-algorithm that is available, but is less robust is the <a href="../../api/public_api/#DuctAPE.CompositeSolverOptions">Composite Solver</a> which partially converges with one solver, and finishes with another.</p><p>Each of the solve methods have a variety of different settings associated with them, detailed in their respective docstrings. The following example should contain all the principles required to be able to adapt to the most complex use cases.</p><pre><code class="language-julia hljs"># Define settings for NLsolve&#39;s newton method
aero_solver_options = DuctAPE.NLsolveOptions(;
    algorithm=:newton,
    atol=1e-10,
    iteration_limit=30,
    linesearch_method=LineSearches.BackTracking, #don&#39;t include parentheses on method handle
    linesearch_kwargs=(; order=3, maxstep=1e6),
    additional_kwargs=(; autoscale=false),
)

# set all the options
DuctAPE.set_options(;
    integration_options=integration_options,
    grid_solver_options=wake_solve_options,
    solver_options=aero_solver_options,
)</code></pre><div class="admonition is-info"><header class="admonition-header">Iteration Counters</header><div class="admonition-body"><p>The <code>iterations</code> field (not to be confused with the <code>iterations_limit</code> field) in the solver options should generally not be changed.  They automatically save (in-place) the number of iterations the solver performs and can be accessed after the analysis is run.</p></div></div><h2 id="Boundary-Layer-Solvers"><a class="docs-heading-anchor" href="#Boundary-Layer-Solvers">Boundary Layer Solvers</a><a id="Boundary-Layer-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Layer-Solvers" title="Permalink"></a></h2><p>If desired, a one-way turbulent boundary layer can be modeled, from which an approximate viscous drag can be determined. Currently, only the Head&#39;s method for turbulent boundary layer computation is working. In the case of separation, a separation drag penalty is applied based on values selected in the options.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DuctAPE.HeadsBoundaryLayerOptions-DuctAPE-advanced_usage-option" href="#DuctAPE.HeadsBoundaryLayerOptions-DuctAPE-advanced_usage-option"><code>DuctAPE.HeadsBoundaryLayerOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct HeadsBoundaryLayerOptions</code></pre><p><strong>Fields:</strong></p><ul><li><code>model_drag::Tb=false</code> : flag to turn on viscous drag approximation</li><li><code>n_steps::Int = Int(2e2)</code> : number of steps to use in boundary layer integration</li><li><code>first_step_size::Float = 1e-6</code> : size of first step in boundary layer integration</li><li><code>offset::Float = 1e-3</code> : size of offset for (where to initialize) boundary layer integration</li><li><code>rk::Function = RK4</code> : solver to use for boundary layer integration (RK4 or RK2 available)</li><li><code>separation_criteria::Float=3.0</code> : value of H12 after which separation should happen.</li><li><code>separation_allowance_upper::Int=10</code> : upper side allowance for how many steps ahead of the trailing edge we&#39;ll allow separation without penalty</li><li><code>separation_allowance_lower::Int=10</code> : lower side allowance for how many steps ahead of the trailing edge we&#39;ll allow separation without penalty</li><li><code>separation_penalty_upper::Float=0.2</code> : upper side maximum penalty value for separation (at leading edge)</li><li><code>separation_penalty_lower::Float=0.2</code> : lower side maximum penalty value for separation (at leading edge)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/DuctAPE.jl/blob/a5ff2ada026adb81962b884154d94aa7bd5f76ae/src/utilities/options.jl#L658-L672">source</a></section></article><p>Here is an example of a possible boundary layer option setting:</p><pre><code class="language-julia hljs"># Define Boundary Layer Settings
boundary_layer_options = DuctAPE.HeadsBoundaryLayerOptions(;
    model_drag=true,
    separation_penalty_upper=0.1,
    separation_penalty_lower=0.1,
    separation_allowance_upper=3,
    separation_allowance_lower=25,
)

# set all the options
DuctAPE.set_options(;
    integration_options=integration_options,
    grid_solver_options=wake_solve_options,
    solver_options=aero_solver_options,
    boundary_layer_options=boundary_layer_options,
)</code></pre><h2 id="Advanced-Options-for-Multi-point-analyses"><a class="docs-heading-anchor" href="#Advanced-Options-for-Multi-point-analyses">Advanced Options for Multi-point analyses</a><a id="Advanced-Options-for-Multi-point-analyses-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Options-for-Multi-point-analyses" title="Permalink"></a></h2><p>For using advanced options in multi-point analyses, there are various changes that need to be made to avoid run-time errors. Here is an example for setting options with the CSOR solver.</p><pre><code class="language-julia hljs"># number of operating points to analyze
nop = 3

options = DuctAPE.set_options(;
    solver_options=DuctAPE.ModCSORSolverOptions(;
        converged=fill(false, (1, nop)), # need a convergence flag for each operating point
        iterations=zeros(Int, (1, nop)), # need a iteration count for each operating point
    ),
    write_outputs=fill(false, nop), # we need to know which of the operating point outputs to write
    outfile=fill(&quot;&quot;, nop), # we need to include names, even if they won&#39;t be used.
    output_tuple_name=fill(&quot;outs&quot;, nop), # we need to include names, even if they won&#39;t be used.
)</code></pre><p>If using a poly-algorithm with a multi-point solve, then each of the solvers needs to have the multiple <code>converged</code> and <code>iterations</code> fields for each operating point, and the overall solve type needs to have a <code>converged</code> and <code>iterations</code> field for each solver and each operating point.</p><pre><code class="language-julia hljs">options = DuctAPE.set_options(;
    solver_options=DuctAPE.ChainSolverOptions(;
        solvers=[ # vector of solvers to use in poly-algorithm
            DuctAPE.NLsolveOptions(;
                algorithm=:anderson,
                atol=1e-12,
                iteration_limit=200,
                converged=fill(false, (1, nop)), # flags for each operating point
                iterations=zeros(Int, (1, nop)), # counters for each operating point
            ),
            DuctAPE.MinpackOptions(;
                atol=1e-12,
                iteration_limit=100,
                converged=fill(false, (1, nop)),
                iterations=zeros(Int, (1, nop)),
            ),
        ],
        converged=fill(false, (2, nop)), # flags for each solver and each operating point
        iterations=zeros(Int, (2, nop)), # counts for each solver and each operating point
    ),
)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorial/">« Getting Started</a><a class="docs-footer-nextpage" href="../precompilation/">Preallocation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Saturday 9 November 2024 15:42">Saturday 9 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
